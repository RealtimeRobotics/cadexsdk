<!-- HTML header for doxygen 1.8.9.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>CAD Exchanger SDK: Logging Support</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link rel="icon" type="image/png" sizes="16x16" href="https://cloud.cadexchanger.com/assets/images/icon16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://cloud.cadexchanger.com/assets/images/icon32.png">
<link rel="icon" type="image/png" sizes="96x96" href="https://cloud.cadexchanger.com/assets/images/icon96.png">
<link href="https://fonts.googleapis.com/css?family=Nunito:300" rel="stylesheet">
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="cadex_doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<a id="logo" href="https://cadexchanger.com/products/sdk" style="height:48px">
  <img id="projectlogo" alt="Logo" src="logo-36.png"/>
  <span id="projectname" style="padding-left:0.5em;">CAD Exchanger SDK</span>
</a>
</div>
<div class="body-content">
<div class="collapsible">
  <a id="show-menu-button" href="#">Hide menu</a>
<!-- Generated by Doxygen 1.8.11 -->
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('sdk_logging_page.html','');});
</script>
<div id="doc-content">
<div class="header">
  <div class="headertitle">
<div class="title">Logging Support </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#sdk_logging_preface">Preface</a></li>
<li class="level1"><a href="#sdk_logging_overview">Overview</a></li>
<li class="level1"><a href="#sdk_logging_level">Message severity level</a></li>
<li class="level1"><a href="#sdk_logging_appenders">Appenders</a></li>
<li class="level1"><a href="#sdk_logging_prebuilt">Prebuilt appenders</a><ul><li class="level2"><a href="#sdk_logging_prebuilt_file">File appender</a></li>
<li class="level2"><a href="#sdk_logging_prebuilt_stream">Stream appender</a></li>
<li class="level2"><a href="#sdk_logging_prebuilt_asynchronous">Asynchronous appender</a></li>
</ul>
</li>
<li class="level1"><a href="#sdk_logging_performance">Performance considerations</a></li>
<li class="level1"><a href="#sdk_logging_multithreading">Multi-threading considerations</a></li>
</ul>
</div>
<div class="textblock"><h1><a class="anchor" id="sdk_logging_preface"></a>
Preface</h1>
<p>Design of the logging mechanism follows one of the Apache library log4cxx (<a href="http://logging.apache.org/log4cxx/">http://logging.apache.org/log4cxx/</a>) which seems to be a reputable reference design for many other derived logging systems. However, CAD Exchanger follows some selected concepts of log4cxx and provides a few extensions for greater flexibility.</p>
<h1><a class="anchor" id="sdk_logging_overview"></a>
Overview</h1>
<p>During execution of the CAD Exchanger algorithms there could be situations which could be worth drawing user's attention. These may range from specific configurations of geometrical objects in the file being imported to some computational errors.</p>
<p>Internally CAD Exchanger tries to communicate this to a global logger object returned by <a class="el" href="classcadex_1_1_base___logger.html#a8fff9a98127a900dd4a186a3c0c7cce6" title="Returns a global logger. ">Base_Logger::GlobalInstance()</a>, which follows the singleton pattern.</p>
<p>Reported messages are assigned a respective severity level (identified by enumeration <a class="el" href="classcadex_1_1_base___logger.html#a11ae664f6711fe0be9a70462b667a16a" title="Defines a message severity level. ">Base_Logger::Level</a>). The level ranges from <a class="el" href="classcadex_1_1_base___logger.html#a11ae664f6711fe0be9a70462b667a16aa0b667c415ab4f8e72f5df3cb5d3a7257">Base_Logger::Trace</a>, e.g. simple notifications that some particular algorithm is being entered or exited, to <a class="el" href="classcadex_1_1_base___logger.html#a11ae664f6711fe0be9a70462b667a16aad8e8b1d0491f00a26aff56b439d7bbdd">Base_Logger::Fatal</a>, which effectively means the application cannot continue and has to abort.</p>
<p>The logger has a threshold level. The messages sent with the same or greater level are accepted, the ones with a lower level are ignored. If the message is accepted, then it is forwarded to all so called appenders registered in the logger for further processing. (The term 'appender' is derived from the log4cxx library.) Appenders subclass <a class="el" href="classcadex_1_1_base___logger_appender.html" title="Base class for all log message appenders. ">Base_LoggerAppender</a> and implement how the message should be processed (e.g. saved in the trace file, displayed in the GUI widget, and so on). Thus, essentially the appenders and the logger implement the observer pattern.</p>
<p>Message delivery is synchronous, i.e. the control is not returned from the logger until all appenders process the message. To enable asynchronous delivery, the library provides <a class="el" href="classcadex_1_1_base___logger_async_appender.html" title="Provides asynchronous message logging. ">Base_LoggerAsyncAppender</a>.</p>
<p>By default, the logger has no appenders and has the highest threshold level and therefore ignores all the messages.</p>
<p>Usage of the logging mechanism by the SDK user should normally be limited to setting a desired logger's threshold level, creating a <a class="el" href="sdk_logging_page.html#sdk_logging_prebuilt">prebuilt</a> observer or a custom one, and registering/unregistering it in the logger. The following code snippet demonstrates this:</p>
<div class="fragment"><div class="line"><span class="comment">// Returns either prebuilt or custom appender, with ensured proper life-span</span></div><div class="line"><span class="keyword">static</span> Base_LoggerAppender&amp; GetAppender()</div><div class="line">{</div><div class="line">    Base_LoggerAppender&amp; anAppender = ...;</div><div class="line">    <span class="keywordflow">return</span> anAppender;</div><div class="line">}</div><div class="line"></div><div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> StartLogging()</div><div class="line">{</div><div class="line">    Base_Logger&amp; aLogger = <a class="code" href="classcadex_1_1_base___logger.html#a8fff9a98127a900dd4a186a3c0c7cce6">Base_Logger::GlobalInstance</a>();</div><div class="line">    aLogger.SetLevel (<a class="code" href="classcadex_1_1_base___logger.html#a11ae664f6711fe0be9a70462b667a16aa355fbf9c8f834eab2078918274c032d3">Base_Logger::Warning</a>);</div><div class="line"></div><div class="line">    Base_LoggerAppender&amp; anAppender = GetAppender();</div><div class="line">    aLogger.Register (anAppender);</div><div class="line">}</div><div class="line"></div><div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> StopLogging()</div><div class="line">{</div><div class="line">    Base_Logger&amp; aLogger = <a class="code" href="classcadex_1_1_base___logger.html#a8fff9a98127a900dd4a186a3c0c7cce6">Base_Logger::GlobalInstance</a>();</div><div class="line">    Base_LoggerAppender&amp; anAppender = GetAppender();</div><div class="line">    aLogger.Unregister (anAppender);</div><div class="line">}</div></div><!-- fragment --><p>There should be no practical need to send own custom messages via the logger by the SDK user.</p>
<h1><a class="anchor" id="sdk_logging_level"></a>
Message severity level</h1>
<p>Message level is defined by an enumeration <a class="el" href="classcadex_1_1_base___logger.html#a11ae664f6711fe0be9a70462b667a16a" title="Defines a message severity level. ">Base_Logger::Level</a>. The following levels are supported (given in the order of decreasing severity): </p><ul>
<li>fatal errors </li>
<li>errors </li>
<li>warnings </li>
<li>information </li>
<li>debug </li>
<li>trace</li>
</ul>
<p><a class="el" href="classcadex_1_1_base___logger.html#ad1d7304521b59978e6b9375f97e9efc4" title="Sets message severity level. ">Base_Logger::SetLevel()</a> sets a threshold level for the messages which should be accepted by the logger and dispatched to the appenders. The messages sent with the same or greater level are accepted, the ones with a lower level are ignored.</p>
<p>The debug and trace levels are reserved for internal purposes and should not be used by the SDK users. An attempt to set either of these levels will set an information level.</p>
<dl class="section note"><dt>Note</dt><dd>Currently no messages are sent with the fatal level.</dd></dl>
<h1><a class="anchor" id="sdk_logging_appenders"></a>
Appenders</h1>
<p>Appender implementation should subclass the abstract class <a class="el" href="classcadex_1_1_base___logger_appender.html" title="Base class for all log message appenders. ">Base_LoggerAppender</a> and implement virtual method <a class="el" href="classcadex_1_1_base___logger_appender.html#a20a6ba55d133e5b7fea60fa850a301e2" title="Appends a message. ">Base_LoggerAppender::Append()</a> accepting a message string (in Unicode).</p>
<p>CAD Exchanger provides a few appender implementations which can be sufficient for most frequent use cases.</p>
<p>Appenders are registered in the logger with <a class="el" href="classcadex_1_1_base___logger.html#a5bf6fa36d6c80cd9e0d9adbf91e5e52b" title="Adds an appender to the logger. ">Base_Logger::Register()</a>. The method accepts an optional range of levels that the appender will accept, essentially serving as a filter for the particular appender: </p><div class="fragment"><div class="line">Base_Logger&amp; aLogger = <a class="code" href="classcadex_1_1_base___logger.html#a8fff9a98127a900dd4a186a3c0c7cce6">Base_Logger::GlobalInstance</a>();</div><div class="line">aLogger.SetLevel (<a class="code" href="classcadex_1_1_base___logger.html#a11ae664f6711fe0be9a70462b667a16aaa210436f822a2d450d4734ed0a319c5d">Base_Logger::Info</a>);</div><div class="line">Base_LoggerStreamAppender aCErrAppender (std::wcerr); <span class="comment">//specific appender for errors</span></div><div class="line">aLogger.Register (aCErrAppender, <a class="code" href="classcadex_1_1_base___logger.html#a11ae664f6711fe0be9a70462b667a16aa7cd2a7983a1df1f951db7cffc2445aeb">Base_Logger::Error</a>, <a class="code" href="classcadex_1_1_base___logger.html#a11ae664f6711fe0be9a70462b667a16aa7cd2a7983a1df1f951db7cffc2445aeb">Base_Logger::Error</a>);</div><div class="line"></div><div class="line"><span class="comment">//run the algorithm...</span></div><div class="line">DoSomething();</div><div class="line"></div><div class="line">aLogger.Unregister (aCErrAppender);</div></div><!-- fragment --><p> For instance, one appender might only accept errors, another - warnings, and so on. By default, the appender is registered with the full range and thus accepts all the messages which have been dispatched by the logger.</p>
<p>The message is dispatched to the appenders in the order they were registered in the logger.</p>
<p>The appender must be unregistered from the logger (<a class="el" href="classcadex_1_1_base___logger.html#a4bd3855273229c0b036f8bf79d6be01e" title="Removes an appender from the logger. ">Base_Logger::Unregister()</a>) before own destruction. Otherwise the logger will store a dangling pointer and dispatching the next accepted message will trigger a crash.</p>
<p>To register a temporary appender with a life span of a scope you may use the helper class <a class="el" href="classcadex_1_1_base___logger_appender_1_1_sentry.html" title="Helper class to unregister the appender from the logger upon own destruction. ">Base_LoggerAppender::Sentry</a> which implements the RAII pattern: </p><div class="fragment"><div class="line">{</div><div class="line">    Base_Logger&amp; aLogger = <a class="code" href="classcadex_1_1_base___logger.html#a8fff9a98127a900dd4a186a3c0c7cce6">Base_Logger::GlobalInstance</a>();</div><div class="line">    Base_LoggerAppender anAppender (...); <span class="comment">//</span></div><div class="line">    Base_LoggerAppender::Sentry aSentry (aLogger, anAppender);</div><div class="line"></div><div class="line">    <span class="comment">//run an algorithm...</span></div><div class="line"></div><div class="line">    <span class="comment">//the Appender will be unregistered from the aLogger in aSentry destructor</span></div><div class="line">}</div></div><!-- fragment --><h1><a class="anchor" id="sdk_logging_prebuilt"></a>
Prebuilt appenders</h1>
<p>CAD Exchanger provides a handful of useful appenders that can be directly used.</p>
<h2><a class="anchor" id="sdk_logging_prebuilt_file"></a>
File appender</h2>
<p><a class="el" href="classcadex_1_1_base___logger_file_appender.html" title="Provides logging messages in the file. ">Base_LoggerFileAppender</a> allows to output messages into the file : </p><div class="fragment"><div class="line">...</div><div class="line">Base_LoggerFileAppender aLogFileAppender (aLogFileName);</div><div class="line">Base_LoggerAppender::Sentry aSentry (aLogger, anAppender);</div><div class="line"></div><div class="line">...</div></div><!-- fragment --><h2><a class="anchor" id="sdk_logging_prebuilt_stream"></a>
Stream appender</h2>
<p><a class="el" href="classcadex_1_1_base___logger_stream_appender.html" title="Provides logging messages in the stream. ">Base_LoggerStreamAppender</a> allows to output messages into the stream. To output messages to standard output the following example can be used: </p><div class="fragment"><div class="line">{</div><div class="line">    Base_Logger&amp; aLogger = <a class="code" href="classcadex_1_1_base___logger.html#a8fff9a98127a900dd4a186a3c0c7cce6">Base_Logger::GlobalInstance</a>();</div><div class="line">    Base_LoggerStreamAppender anAppender (std::wcout); <span class="comment">//note the wcout</span></div><div class="line"></div><div class="line">    ...</div><div class="line">}</div></div><!-- fragment --><h2><a class="anchor" id="sdk_logging_prebuilt_asynchronous"></a>
Asynchronous appender</h2>
<p><a class="el" href="classcadex_1_1_base___logger_async_appender.html" title="Provides asynchronous message logging. ">Base_LoggerAsyncAppender</a> allows to process messages asynchronously. The appender forwards the received message to other appenders registered with <a class="el" href="classcadex_1_1_base___logger_async_appender.html#a7d0acb85093af02baca045a0cbf9359f" title="Adds an appender. ">Base_LoggerAsyncAppender::Register()</a>. Forwarding happens in a separate thread created for each asynchronous appender.</p>
<p>This appender is useful when message processing can be time-consuming and thus would block algorithm execution for too long if happened synchronously.</p>
<p>The following code snippet demonstrates usage of the asynchronous appender: </p><div class="fragment"><div class="line">Base_Logger&amp; aLogger = <a class="code" href="classcadex_1_1_base___logger.html#a8fff9a98127a900dd4a186a3c0c7cce6">Base_Logger::GlobalInstance</a>();</div><div class="line">Base_LoggerAsyncAppender anAsyncAppender;</div><div class="line">{</div><div class="line">    Base_LoggerAppender::Sentry aSentry (aLogger, anAsyncAppender);</div><div class="line"></div><div class="line">    MyVeryHeavyAppender aHeavyAppender = ...;</div><div class="line">    anAsyncAppender.Register (aHeavyAppender);</div><div class="line"></div><div class="line">    DoSomething();</div><div class="line">}</div></div><!-- fragment --><h1><a class="anchor" id="sdk_logging_performance"></a>
Performance considerations</h1>
<p>Internal implementation minimizes overhead associated with the use of logging mechanism.</p>
<p>By default, when the logger has no registered appenders and has the highest message level threshold, the decision to ignore a message approximately equals to about one function call and one integer comparison. The message is constructed in a lazy manner, i.e. after the logger responded that it would accept the message.</p>
<p>In the case when a logger accepts a message the performance is essentially determined by the performance of a particular implementation of <a class="el" href="classcadex_1_1_base___logger_appender.html#a20a6ba55d133e5b7fea60fa850a301e2" title="Appends a message. ">Base_LoggerAppender::Append()</a> method.</p>
<p>If you have to use heavy-weight appenders consider using asynchronous appender (<a class="el" href="classcadex_1_1_base___logger_async_appender.html" title="Provides asynchronous message logging. ">Base_LoggerAsyncAppender</a>) as a proxy object.</p>
<h1><a class="anchor" id="sdk_logging_multithreading"></a>
Multi-threading considerations</h1>
<p>The logger provides thread-safe management of the list of registered appenders. If the messages are being fed into the logger from multiple threads then the next message will be accepted only after the previous message has been processed by all appenders.</p>
<p>The asynchronous appender (<a class="el" href="classcadex_1_1_base___logger_async_appender.html" title="Provides asynchronous message logging. ">Base_LoggerAsyncAppender</a>) also provides thread-safe management of its own appenders. All appenders process accepted messages in a single thread created by the asynchronous appender.</p>
<p>Thus normally there should be no situations when any appender is accessed for writing from multiple threads, and therefore no special efforts should be applied at user's level to ensure thread-safety. Of course, access to the same resource by different appenders (e.g. global standard output accessed by different stream appenders from different asynchronous appenders) is not thread-safe. </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
</div>
<div id="nav-path" class="navpath">
  <ul>
    <li class="footer">
      <a href="https://cadexchanger.com/custom-development" style="background: #226daa; color:#fff; padding: 6px; text-decoration: none; border-radius: 5px;">Custom Development</a>
      <a href="https://cadexchanger.com/products/gui" style="margin:5px;">GUI</a>
      <a href="https://cadexchanger.com/products/sdk" style="margin:5px;">SDK</a>
      <a href="https://cadexchanger.com/products/cli" style="margin:5px;">CLI</a>
      <a href="https://cadexchanger.com/products/web-toolkit" style="margin:5px;">Web Toolkit</a>
      <a href="https://cadexchanger.com/products/cloud" style="margin:5px;">Cloud</a>
      <a href="https://cadexchanger.com/products/cloud-api" style="margin:5px;">Cloud API</a>
      <a href="https://cadexchanger.com/iges" style="margin:5px; color: #838383;">IGES</a>
      <a href="https://cadexchanger.com/step" style="margin:5px; color: #838383;">STEP</a>
      <a href="https://cadexchanger.com/parasolid" style="margin:5px; color: #838383;">Parasolid</a>
      <a href="https://cadexchanger.com/acis" style="margin:5px; color: #838383;">ACIS</a>
      <a href="https://cadexchanger.com/jt" style="margin:5px; color: #838383;">JT</a>
      <a href="https://cadexchanger.com/stl" style="margin:5px; color: #838383;">STL</a>
      <a href="https://cadexchanger.com/obj" style="margin:5px; color: #838383;">OBJ</a>
      <a href="https://cadexchanger.com/solidworks" style="margin:5px; color: #838383;">SolidWorks</a>
      <a href="https://cadexchanger.com/creo" style="margin:5px; color: #838383;">Creo</a>
      <a href="https://cadexchanger.com/nx" style="margin:5px; color: #838383;">NX</a>
      <a href="https://cadexchanger.com/catia" style="margin:5px; color: #838383;">CATIA</a>
      <a href="https://cadexchanger.com/ifc" style="margin:5px; color: #838383;">IFC</a>
      <a href="https://cadexchanger.com/rhino" style="margin:5px; color: #838383;">Rhino</a>
      <a href="https://cadexchanger.com/vrml" style="margin:5px; color: #838383;">VRML</a>
      <a href="https://cadexchanger.com/fbx" style="margin:5px; color: #838383;">FBX</a>
      <a href="https://cadexchanger.com/gltf" style="margin:5px; color: #838383;">GLTF</a>
      <a href="https://cadexchanger.com/dxf" style="margin:5px; color: #838383;">DXF</a>
      <a href="https://cadexchanger.com/dwg" style="margin:5px; color: #838383;">DWG</a>
      <a href="https://cadexchanger.com/collada" style="margin:5px; color: #838383;">Collada</a>
      <a href="https://cadexchanger.com/3ds" style="margin:5px; color: #838383;">3DS</a>
      <a href="https://cadexchanger.com/x3d" style="margin:5px; color: #838383;">X3D</a>
      <a href="https://cadexchanger.com/3mf" style="margin:5px; color: #838383;">3MF</a>
      <a href="https://cadexchanger.com/u3d" style="margin:5px; color: #838383;">U3D</a>
      <a href="https://cadexchanger.com/3dpdf" style="margin:5px; color: #838383;">3D PDF</a>
      <a href="https://cadexchanger.com/prc" style="margin:5px; color: #838383;">PRC</a>
      <a href="https://cadexchanger.com/brep" style="margin:5px; color: #838383;">BRep</a>
      <a href="https://cadexchanger.com/usd" style="margin:5px; color: #838383;">USD</a>
      <a href="https://cadexchanger.com/" style="margin:5px; color: #838383;">cadexchanger.com</a>
    </li>
  </ul>
</div>
</body>
</html>
