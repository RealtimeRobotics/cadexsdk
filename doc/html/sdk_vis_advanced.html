<!-- HTML header for doxygen 1.8.9.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>CAD Exchanger SDK: Advanced techniques</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link rel="icon" type="image/png" sizes="16x16" href="https://cloud.cadexchanger.com/assets/images/icon16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://cloud.cadexchanger.com/assets/images/icon32.png">
<link rel="icon" type="image/png" sizes="96x96" href="https://cloud.cadexchanger.com/assets/images/icon96.png">
<link href="https://fonts.googleapis.com/css?family=Nunito:300" rel="stylesheet">
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="cadex_doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<a id="logo" href="https://cadexchanger.com/products/sdk" style="height:48px">
  <img id="projectlogo" alt="Logo" src="logo-36.png"/>
  <span id="projectname" style="padding-left:0.5em;">CAD Exchanger SDK</span>
</a>
</div>
<div class="body-content">
<div class="collapsible">
  <a id="show-menu-button" href="#">Hide menu</a>
<!-- Generated by Doxygen 1.8.11 -->
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('sdk_vis_advanced.html','');});
</script>
<div id="doc-content">
<div class="header">
  <div class="headertitle">
<div class="title">Advanced techniques </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#sdk_visualisation_advanced_pimpl">Using pimpl pattern</a></li>
<li class="level1"><a href="#sdk_visualisation_advanced_offscreen">Offscreen rendering and screenshot generation</a></li>
<li class="level1"><a href="#sdk_visualisation_advanced_asynchronous">Asynchronous display</a></li>
<li class="level1"><a href="#sdk_visualisation_advanced_user_defined_geometry_data">User-defined geometry data support</a></li>
<li class="level1"><a href="#sdk_visualisation_advanced_user_defined_scene_node_data">User-defined scene node data support</a></li>
<li class="level1"><a href="#sdk_visualisation_advanced_interoperability">Interoperability with user-defined 3D viewports</a></li>
</ul>
</div>
<div class="textblock"><h1><a class="anchor" id="sdk_visualisation_advanced_pimpl"></a>
Using pimpl pattern</h1>
<p>Most classes used in the visualization component (including <a class="el" href="classcadex_1_1_model_prs___scene_node.html" title="Represents a node in the visual scene graph. ">ModelPrs_SceneNode</a> subclass) use the "pimpl" (private implementation) idiom. The class subclasses <a class="el" href="classcadex_1_1_base___public_object.html" title="Base class for all public classes. ">Base_PublicObject</a> which has a shared pointer (Base_Handle) to a private implementation.</p>
<p>This allows to ensure binary compatibility with future versions as well as to pass the objects themselves by their copies, which are essentially shallow ones. For instance, in the following code snippet:</p>
<div class="fragment"><div class="line">std::vector&lt;ModelPrs_SceneNode&gt; v;</div><div class="line">ModelPrs_SceneNode aRootNode = <a class="code" href="classcadex_1_1_model_prs___scene_node_factory.html#a0c8c95bc0458ef5d9d06ea9fa49a7c9f">ModelPrs_SceneNodeFactory::Create</a> (anAssembly);</div><div class="line">v.push_back (aRootNode);</div></div><!-- fragment --><p>placing <em>aRootNode</em> in the vector <em>does</em> not incur any deep copy.</p>
<h1><a class="anchor" id="sdk_visualisation_advanced_offscreen"></a>
Offscreen rendering and screenshot generation</h1>
<p>In addition to platform-specific back-ends (and their respective viewports), CAD Exchanger SDK supports offscreen viewport.</p>
<p>Such a viewport can be particularly useful for screenshot generation. This functionality is used by CAD Exchanger GUI and CAD Exchanger Cloud when generating thumbnails of imported 3D models:</p>
<div class="image">
<img src="vis_cloud_thumbnail.png" alt="vis_cloud_thumbnail.png"/>
<div class="caption">
CAD Exchanger Cloud dashboard</div></div>
<p>A code snippet for screenshot generation can be found in <a class="el" href="sdk_vis_3dview_operations.html#sdk_vis_3dview_operations_initializing_offscreen">Offscreen component</a>.</p>
<h1><a class="anchor" id="sdk_visualisation_advanced_asynchronous"></a>
Asynchronous display</h1>
<p>CAD Exchanger SDK, including its visualization component, intensively uses multi-threading in order to provide the best user experience.</p>
<p>The visualization component utilizes multi-threading in order to perform heavy-weight computations when preparing visual presentations of 3D models. This may include concurrent invoking the <a class="el" href="classcadex_1_1_model_algo___b_rep_mesher.html">visualization mesher</a> if the B-Rep representation has not been tessellated yet, populating internal data structures with triangles and colors, used for further rendering, etc. Rendering itself may also happen in a separate thread, distinct from the UI thread that invoked the display process.</p>
<p>The following diagram shows possible organization of the computations and other tasks:</p>
<div class="image">
<img src="vis_async_displaying.png" alt="vis_async_displaying.png"/>
<div class="caption">
Gradual display of the 3D model while maintaining interactive UI</div></div>
<p> All this allows to balance the heavy-weight tasks among available compute resources on the system and to support responsive UI in the user’s application (including gradual display of large assemblies):</p>
<div class="image">
<img src="vis_displaying.gif" alt="vis_displaying.gif"/>
</div>
<h1><a class="anchor" id="sdk_visualisation_advanced_user_defined_geometry_data"></a>
User-defined geometry data support</h1>
<p>At the time of writing this User’s Guide, the CAD Exchanger SDK visualization component has been mainly tailored to display data specified via the ModelData classes API (such as <a class="el" href="classcadex_1_1_model_data___model.html" title="Provides CAD Exchanger data model. ">ModelData_Model</a>, <a class="el" href="classcadex_1_1_model_data___assembly.html" title="Defines a group of scene graph element. ">ModelData_Assembly</a>, <a class="el" href="classcadex_1_1_model_data___part.html" title="Defines a leaf node in the scene graph hiearchy. ">ModelData_Part</a>, <a class="el" href="classcadex_1_1_model_data___shape.html" title="Base class of topological shapes. ">ModelData_Shape</a> for B-Reps, <a class="el" href="classcadex_1_1_model_data___poly_vertex_set.html" title="Base class for particular vertex sets - triangle sets, polyline sets, point sets. ...">ModelData_PolyVertexSet</a> for meshes, etc). However, internal implementation has been made flexible enough to enable custom data support. Future releases of CAD Exchanger SDK will provide additional API to directly support user-defined data when interim storage in the ModelData classes may be suboptimal.</p>
<h1><a class="anchor" id="sdk_visualisation_advanced_user_defined_scene_node_data"></a>
User-defined scene node data support</h1>
<p>Any application-specific can be attached to a scene node using <a class="el" href="classcadex_1_1_model_prs___scene_node.html#a056d44fec055adc4d920da5f68d2c81b" title="Sets user data or nullify it if theUserData is nullptr. ">ModelPrs_SceneNode::SetUserData()</a>. Semantics and use of this data is entirely up to the user's application.</p>
<p>The following example demonstrates attaching a name and a centroid to a scene node which are used later on in a selection event:</p>
<div class="fragment"><div class="line"><span class="keyword">class </span>CustomData : <span class="keyword">public</span> ModelPrs_SceneNode::Data</div><div class="line">{</div><div class="line"><span class="keyword">public</span>:</div><div class="line">    CustomData (<span class="keyword">const</span> Base_UTF16String&amp; theName, <span class="keyword">const</span> ModelData_Point&amp; theCOG) : myName (theName), myCentroid (theCOG)</div><div class="line"></div><div class="line">    Base_UTF16String    myName;</div><div class="line">    ModelData_Point     myCentroid;</div><div class="line">};</div><div class="line"></div><div class="line">aNode.SetUserData (std::make_shared&lt;CustomData&gt; (aName, aCentroid));</div></div><!-- fragment --><p>For example this data may be useful when selection event occur:</p>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> Visit (<span class="keyword">const</span> ModelPrs_SceneNode&amp; theNode) <span class="keyword">override</span> <span class="comment">// the node itself is selected</span></div><div class="line">{</div><div class="line">    <span class="keywordflow">if</span> (<span class="keyword">auto</span> aCustomData = std::dynamic_pointer_cast&lt;CustomData&gt; (theNode.UserData()) {</div><div class="line">        <span class="keyword">auto</span> c = aCustomData.myCentroid;</div><div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;Selected node \&quot;&quot;</span> &lt;&lt; aCustomData.myName.ToUTF8().String().c_str()</div><div class="line">                  &lt;&lt; <span class="stringliteral">&quot;\&quot; with centroid: (&quot;</span> &lt;&lt; c.X() &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; c.Y() &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; c.Z() &lt;&lt; <span class="stringliteral">&quot;)&quot;</span> &lt;&lt; std::endl;</div><div class="line">    }</div><div class="line">}</div></div><!-- fragment --><dl class="section see"><dt>See also</dt><dd><a class="el" href="sdk_vis_scene_management.html#sdk_vis_scene_management_hover_selection">Hover and selection</a></dd></dl>
<p>For technical reasons, the User-defined data feature is available only for C++.</p>
<p>Refer to <a class="el" href="sdk_examples_selection_handling.html">Selection Handling Example</a> to see feature usage and workaround for other languages.</p>
<h1><a class="anchor" id="sdk_visualisation_advanced_interoperability"></a>
Interoperability with user-defined 3D viewports</h1>
<p>If the user’s application already utilizes certain 3D viewport to display own data then it is possible to make CAD Exchanger’s viewport to co-exist with that existing viewport.</p>
<p>To be added. </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
</div>
<div id="nav-path" class="navpath">
  <ul>
    <li class="footer">
      <a href="https://cadexchanger.com/custom-development" style="background: #226daa; color:#fff; padding: 6px; text-decoration: none; border-radius: 5px;">Custom Development</a>
      <a href="https://cadexchanger.com/products/gui" style="margin:5px;">GUI</a>
      <a href="https://cadexchanger.com/products/sdk" style="margin:5px;">SDK</a>
      <a href="https://cadexchanger.com/products/cli" style="margin:5px;">CLI</a>
      <a href="https://cadexchanger.com/products/web-toolkit" style="margin:5px;">Web Toolkit</a>
      <a href="https://cadexchanger.com/products/cloud" style="margin:5px;">Cloud</a>
      <a href="https://cadexchanger.com/products/cloud-api" style="margin:5px;">Cloud API</a>
      <a href="https://cadexchanger.com/iges" style="margin:5px; color: #838383;">IGES</a>
      <a href="https://cadexchanger.com/step" style="margin:5px; color: #838383;">STEP</a>
      <a href="https://cadexchanger.com/parasolid" style="margin:5px; color: #838383;">Parasolid</a>
      <a href="https://cadexchanger.com/acis" style="margin:5px; color: #838383;">ACIS</a>
      <a href="https://cadexchanger.com/jt" style="margin:5px; color: #838383;">JT</a>
      <a href="https://cadexchanger.com/stl" style="margin:5px; color: #838383;">STL</a>
      <a href="https://cadexchanger.com/obj" style="margin:5px; color: #838383;">OBJ</a>
      <a href="https://cadexchanger.com/solidworks" style="margin:5px; color: #838383;">SolidWorks</a>
      <a href="https://cadexchanger.com/creo" style="margin:5px; color: #838383;">Creo</a>
      <a href="https://cadexchanger.com/nx" style="margin:5px; color: #838383;">NX</a>
      <a href="https://cadexchanger.com/catia" style="margin:5px; color: #838383;">CATIA</a>
      <a href="https://cadexchanger.com/ifc" style="margin:5px; color: #838383;">IFC</a>
      <a href="https://cadexchanger.com/rhino" style="margin:5px; color: #838383;">Rhino</a>
      <a href="https://cadexchanger.com/vrml" style="margin:5px; color: #838383;">VRML</a>
      <a href="https://cadexchanger.com/fbx" style="margin:5px; color: #838383;">FBX</a>
      <a href="https://cadexchanger.com/gltf" style="margin:5px; color: #838383;">GLTF</a>
      <a href="https://cadexchanger.com/dxf" style="margin:5px; color: #838383;">DXF</a>
      <a href="https://cadexchanger.com/dwg" style="margin:5px; color: #838383;">DWG</a>
      <a href="https://cadexchanger.com/collada" style="margin:5px; color: #838383;">Collada</a>
      <a href="https://cadexchanger.com/3ds" style="margin:5px; color: #838383;">3DS</a>
      <a href="https://cadexchanger.com/x3d" style="margin:5px; color: #838383;">X3D</a>
      <a href="https://cadexchanger.com/3mf" style="margin:5px; color: #838383;">3MF</a>
      <a href="https://cadexchanger.com/u3d" style="margin:5px; color: #838383;">U3D</a>
      <a href="https://cadexchanger.com/3dpdf" style="margin:5px; color: #838383;">3D PDF</a>
      <a href="https://cadexchanger.com/prc" style="margin:5px; color: #838383;">PRC</a>
      <a href="https://cadexchanger.com/brep" style="margin:5px; color: #838383;">BRep</a>
      <a href="https://cadexchanger.com/usd" style="margin:5px; color: #838383;">USD</a>
      <a href="https://cadexchanger.com/" style="margin:5px; color: #838383;">cadexchanger.com</a>
    </li>
  </ul>
</div>
</body>
</html>
