<!-- HTML header for doxygen 1.8.9.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>CAD Exchanger SDK: Scene Graph</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link rel="icon" type="image/png" sizes="16x16" href="https://cloud.cadexchanger.com/assets/images/icon16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://cloud.cadexchanger.com/assets/images/icon32.png">
<link rel="icon" type="image/png" sizes="96x96" href="https://cloud.cadexchanger.com/assets/images/icon96.png">
<link href="https://fonts.googleapis.com/css?family=Nunito:300" rel="stylesheet">
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="cadex_doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<a id="logo" href="https://cadexchanger.com/products/sdk" style="height:48px">
  <img id="projectlogo" alt="Logo" src="logo-36.png"/>
  <span id="projectname" style="padding-left:0.5em;">CAD Exchanger SDK</span>
</a>
</div>
<div class="body-content">
<div class="collapsible">
  <a id="show-menu-button" href="#">Hide menu</a>
<!-- Generated by Doxygen 1.8.11 -->
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('sdk_vis_scene_graph.html','');});
</script>
<div id="doc-content">
<div class="header">
  <div class="headertitle">
<div class="title">Scene Graph </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#sdk_vis_scene_graph_principles">Key principles</a></li>
<li class="level1"><a href="#sdk_vis_scene_graph_creating">Creating a scene graph</a></li>
<li class="level1"><a href="#sdk_vis_scene_graph_traversing">Traversing scene graph</a></li>
<li class="level1"><a href="#sdk_vis_scene_graph_attributes_inheritance">Node attributes inheritance</a></li>
</ul>
</div>
<div class="textblock"><h1><a class="anchor" id="sdk_vis_scene_graph_principles"></a>
Key principles</h1>
<p>Visualization scene graph is a hierarchical definition of a 3D model to be rendered.</p>
<p>The scene graph concept has been deliberately chosen to efficiently map CAD-tailored data to visualization semantics. Therefore <a class="el" href="classcadex_1_1_model_data___model.html" title="Provides CAD Exchanger data model. ">ModelData_Model</a> used to provide a (mathematical) definition of a 3D model (via assemblies and parts, B-Reps and meshes) so naturally maps to the visualization scene graph. However, the scene graph can also be created directly from custom user’s data, without initial mathematical model.</p>
<div class="image">
<img src="vis_scene.png" alt="vis_scene.png"/>
<div class="caption">
Scene graph encapsulated by a scene</div></div>
<p>The scene graph consists of scene nodes and is acyclical (i.e. is a tree). Thus each node may have a single parent and zero, one or more children. A node without a parent is a root node. A scene may have multiple roots.</p>
<p>A scene node is represented by a single class <a class="el" href="classcadex_1_1_model_prs___scene_node.html" title="Represents a node in the visual scene graph. ">ModelPrs_SceneNode</a> and thus is not typed. Semantics of the node (e.g. whether it corresponds to original part or assembly, or any user-specific data) is application-specific.</p>
<p>A scene node has various data attributes that define visual presentation of the object or the sub-tree the node represents. By convention, geometrical data should only be attached to leaf nodes, whereas other attributes (such as transformations or visual appearances) can be attached to the interim nodes in the hierarchy (see <a class="el" href="sdk_vis_scene_graph.html#sdk_vis_scene_graph_attributes_inheritance">Node attributes inheritance</a>).</p>
<p>A scene node may have attributes that affect display of a sub-tree it represents. These attributes can contain:</p>
<ul>
<li>Mesh or geometrical definition (triangles, polylines, points) </li>
<li>Visual appearance (colors, materials, textures, line styles, etc) </li>
<li>Transformations (e.g. 3x4 or 4x4 matrices) </li>
<li>Display modes (shading or wireframe, semi-transparent or full hiding, etc)</li>
</ul>
<p>Scene nodes may not be shared among parents, sharing of heavy-weight data (e.g. geometry) is provided via shareable attributes. A scene node is represented by a single class <a class="el" href="classcadex_1_1_model_prs___scene_node.html" title="Represents a node in the visual scene graph. ">ModelPrs_SceneNode</a> and thus is not typed. Semantics of the node (e.g. whether it corresponds to original part or assembly, or any user-specific data) is application-specific and can be, for instance, defined by attached attributes.</p>
<h1><a class="anchor" id="sdk_vis_scene_graph_creating"></a>
Creating a scene graph</h1>
<p>A node (and its sub-graph) is created with the help of <a class="el" href="classcadex_1_1_model_prs___scene_node_factory.html" title="Creates a scene node and its children from input data model objects. ">ModelPrs_SceneNodeFactory</a> as follows: </p><div class="fragment"><div class="line">ModelData_Model aModel = ...;</div><div class="line">ModelPrs_SceneNodeFactory aFactory (ModelData_RM_BRep); <span class="comment">//will use B-Rep representations when creating scene nodes</span></div><div class="line">ModelPrs_SceneNode aRootNode = aFactory.Create (aModel);</div><div class="line">ModelPrs_Scene aScene;</div><div class="line">aScene.AddRoot (aRootNode);</div><div class="line">aScene.Update();</div></div><!-- fragment --><p>The following diagram demonstrates mapping of a mathematical definition (via <a class="el" href="classcadex_1_1_model_data___model.html" title="Provides CAD Exchanger data model. ">ModelData_Model</a>) to the scene graph of the assembly:</p>
<div class="image">
<img src="dm_assembly_sg.png" alt="dm_assembly_sg.png"/>
<div class="caption">
Scene graph of an assembly model</div></div>
 <div class="image">
<img src="vis_as1_scene_nodes.png" alt="vis_as1_scene_nodes.png"/>
<div class="caption">
Resulting visualization scene graph</div></div>
<p> The scene node's names on second diagram (blue rectangles) written here for more clear understanding and doesn't store in scene node actually.</p>
<h1><a class="anchor" id="sdk_vis_scene_graph_traversing"></a>
Traversing scene graph</h1>
<p>Visualization Scene Graph can be traversed with the help of visitors.</p>
<p>Each scene node accepts a visitor which must be a subclass of an abstract class <a class="el" href="classcadex_1_1_model_prs___scene_node_visitor.html" title="Defines a visitor of the scene nodes. ">ModelPrs_SceneNodeVisitor</a> with overridden methods. If the redefined VisitEnter() method returns false then the respective subgraph will not be visited.</p>
<p>The following example demonstrates how to count of all scene nodes: </p><div class="fragment"><div class="line"><span class="keyword">class </span>SceneNodeCounter : <span class="keyword">public</span> ModelPrs_SceneNodeVisitor</div><div class="line">{</div><div class="line"><span class="keyword">public</span>:</div><div class="line">    SceneNodeCounter() : myNodeCount (0) { }</div><div class="line">    <span class="keywordtype">bool</span> VisitEnter (<span class="keyword">const</span> ModelPrs_SceneNode&amp; <span class="comment">/*theNode*/</span>)<span class="keyword"> override </span>{ ++myNodeCount; <span class="keywordflow">return</span> <span class="keyword">true</span>; }</div><div class="line">    <span class="keywordtype">void</span> VisitLeave (<span class="keyword">const</span> ModelPrs_SceneNode&amp; <span class="comment">/*theNode*/</span>)<span class="keyword"> override </span>{ }</div><div class="line">    <span class="keywordtype">size_t</span> NodeCount()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> myNodeCount; }</div><div class="line"><span class="keyword">private</span>:</div><div class="line">    <span class="keywordtype">size_t</span> myNodeCount;</div><div class="line">};</div><div class="line"></div><div class="line">SceneNodeCounter aCounter;</div><div class="line">aNode.Accept (aCounter);</div><div class="line">std::cout &lt;&lt; <span class="stringliteral">&quot;Node count: &quot;</span> &lt;&lt; aCounter.NodeCount() &lt;&lt; std::endl;</div></div><!-- fragment --><h1><a class="anchor" id="sdk_vis_scene_graph_attributes_inheritance"></a>
Node attributes inheritance</h1>
<p>The following rules determine how attributes redefined in sub-nodes (i.e. downward when traversing the scene graph) are taken into account:</p>
<table class="doxtable">
<tr>
<th>Atrribute</th><th>Rule </th></tr>
<tr>
<td>Appearance</td><td>Combine with parent's </td></tr>
<tr>
<td>Display mode</td><td>Overrides parent’s if defined, or inherited from parent otherwise. </td></tr>
<tr>
<td>Geometry</td><td>Used wherever explicitly defined. </td></tr>
<tr>
<td>Selection mode</td><td>Overrides parent’s if defined, or inherited from parent otherwise. </td></tr>
<tr>
<td>Transformation</td><td>Multiplication </td></tr>
<tr>
<td>Visibility mode</td><td>Boolean AND. Thus, if the node is invisible then its sub-graph is invisible. </td></tr>
</table>
</div></div><!-- contents -->
</div><!-- doc-content -->
</div>
<div id="nav-path" class="navpath">
  <ul>
    <li class="footer">
      <a href="https://cadexchanger.com/custom-development" style="background: #226daa; color:#fff; padding: 6px; text-decoration: none; border-radius: 5px;">Custom Development</a>
      <a href="https://cadexchanger.com/products/gui" style="margin:5px;">GUI</a>
      <a href="https://cadexchanger.com/products/sdk" style="margin:5px;">SDK</a>
      <a href="https://cadexchanger.com/products/cli" style="margin:5px;">CLI</a>
      <a href="https://cadexchanger.com/products/web-toolkit" style="margin:5px;">Web Toolkit</a>
      <a href="https://cadexchanger.com/products/cloud" style="margin:5px;">Cloud</a>
      <a href="https://cadexchanger.com/products/cloud-api" style="margin:5px;">Cloud API</a>
      <a href="https://cadexchanger.com/iges" style="margin:5px; color: #838383;">IGES</a>
      <a href="https://cadexchanger.com/step" style="margin:5px; color: #838383;">STEP</a>
      <a href="https://cadexchanger.com/parasolid" style="margin:5px; color: #838383;">Parasolid</a>
      <a href="https://cadexchanger.com/acis" style="margin:5px; color: #838383;">ACIS</a>
      <a href="https://cadexchanger.com/jt" style="margin:5px; color: #838383;">JT</a>
      <a href="https://cadexchanger.com/stl" style="margin:5px; color: #838383;">STL</a>
      <a href="https://cadexchanger.com/obj" style="margin:5px; color: #838383;">OBJ</a>
      <a href="https://cadexchanger.com/solidworks" style="margin:5px; color: #838383;">SolidWorks</a>
      <a href="https://cadexchanger.com/creo" style="margin:5px; color: #838383;">Creo</a>
      <a href="https://cadexchanger.com/nx" style="margin:5px; color: #838383;">NX</a>
      <a href="https://cadexchanger.com/catia" style="margin:5px; color: #838383;">CATIA</a>
      <a href="https://cadexchanger.com/ifc" style="margin:5px; color: #838383;">IFC</a>
      <a href="https://cadexchanger.com/rhino" style="margin:5px; color: #838383;">Rhino</a>
      <a href="https://cadexchanger.com/vrml" style="margin:5px; color: #838383;">VRML</a>
      <a href="https://cadexchanger.com/fbx" style="margin:5px; color: #838383;">FBX</a>
      <a href="https://cadexchanger.com/gltf" style="margin:5px; color: #838383;">GLTF</a>
      <a href="https://cadexchanger.com/dxf" style="margin:5px; color: #838383;">DXF</a>
      <a href="https://cadexchanger.com/dwg" style="margin:5px; color: #838383;">DWG</a>
      <a href="https://cadexchanger.com/collada" style="margin:5px; color: #838383;">Collada</a>
      <a href="https://cadexchanger.com/3ds" style="margin:5px; color: #838383;">3DS</a>
      <a href="https://cadexchanger.com/x3d" style="margin:5px; color: #838383;">X3D</a>
      <a href="https://cadexchanger.com/3mf" style="margin:5px; color: #838383;">3MF</a>
      <a href="https://cadexchanger.com/u3d" style="margin:5px; color: #838383;">U3D</a>
      <a href="https://cadexchanger.com/3dpdf" style="margin:5px; color: #838383;">3D PDF</a>
      <a href="https://cadexchanger.com/prc" style="margin:5px; color: #838383;">PRC</a>
      <a href="https://cadexchanger.com/brep" style="margin:5px; color: #838383;">BRep</a>
      <a href="https://cadexchanger.com/usd" style="margin:5px; color: #838383;">USD</a>
      <a href="https://cadexchanger.com/" style="margin:5px; color: #838383;">cadexchanger.com</a>
    </li>
  </ul>
</div>
</body>
</html>
